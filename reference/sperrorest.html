<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform spatial error estimation and variable importance assessment — sperrorest • sperrorest</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Perform spatial error estimation and variable importance assessment — sperrorest" />
<meta property="og:description" content="sperrorest is a flexible interface for multiple types of
parallelized spatial and non-spatial cross-validation and bootstrap error
estimation and parallelized permutation-based assessment of spatial variable
importance." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sperrorest</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.0.3.1001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/custom-pred-and-model-functions.html">Custom Predict and Model Functions</a>
    </li>
    <li>
      <a href="../articles/spatial-modeling-use-case.html">Spatial Modeling Using Statistical Learning Techniques</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/giscience-fsu/sperrorest/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform spatial error estimation and variable importance assessment</h1>
    <small class="dont-index">Source: <a href='https://github.com/giscience-fsu/sperrorest/blob/master/R/sperrorest.R'><code>R/sperrorest.R</code></a></small>
    <div class="hidden name"><code>sperrorest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>sperrorest is a flexible interface for multiple types of
parallelized spatial and non-spatial cross-validation and bootstrap error
estimation and parallelized permutation-based assessment of spatial variable
importance.</p>
    </div>

    <pre class="usage"><span class='fu'>sperrorest</span><span class='op'>(</span>
  <span class='va'>formula</span>,
  <span class='va'>data</span>,
  coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"y"</span><span class='op'>)</span>,
  <span class='va'>model_fun</span>,
  model_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  pred_fun <span class='op'>=</span> <span class='cn'>NULL</span>,
  pred_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  smp_fun <span class='op'>=</span> <span class='va'>partition_cv</span>,
  smp_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  train_fun <span class='op'>=</span> <span class='cn'>NULL</span>,
  train_param <span class='op'>=</span> <span class='cn'>NULL</span>,
  test_fun <span class='op'>=</span> <span class='cn'>NULL</span>,
  test_param <span class='op'>=</span> <span class='cn'>NULL</span>,
  err_fun <span class='op'>=</span> <span class='va'>err_default</span>,
  imp_variables <span class='op'>=</span> <span class='cn'>NULL</span>,
  imp_permutations <span class='op'>=</span> <span class='fl'>1000</span>,
  imp_sample_from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"test"</span>, <span class='st'>"train"</span>, <span class='st'>"all"</span><span class='op'>)</span>,
  importance <span class='op'>=</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>imp_variables</span><span class='op'>)</span>,
  distance <span class='op'>=</span> <span class='cn'>FALSE</span>,
  do_gc <span class='op'>=</span> <span class='fl'>1</span>,
  progress <span class='op'>=</span> <span class='st'>"all"</span>,
  benchmark <span class='op'>=</span> <span class='cn'>FALSE</span>,
  mode_rep <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"future"</span>, <span class='st'>"sequential"</span>, <span class='st'>"loop"</span><span class='op'>)</span>,
  mode_fold <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"sequential"</span>, <span class='st'>"future"</span>, <span class='st'>"loop"</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='fl'>0</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>A formula specifying the variables used by the <code>model</code>. Only
simple formulas without interactions or nonlinear terms should be used,
e.g. <code>y~x1+x2+x3</code> but not <code>y~x1*x2+log(x3)</code>. Formulas involving interaction
and nonlinear terms may possibly work for error estimation but not for
variable importance assessment, but should be used with caution.
The formula <code>y~...</code> is not supported, but <code>y~1</code> (i.e. no predictors) is.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a <code>data.frame</code> with predictor and response variables. Training
and test samples will be drawn from this data set by <code>train_fun</code> and
<code>test_fun</code>, respectively.</p></td>
    </tr>
    <tr>
      <th>coords</th>
      <td><p>vector of length 2 defining the variables in <code>data</code> that
contain the x and y coordinates of sample locations.</p></td>
    </tr>
    <tr>
      <th>model_fun</th>
      <td><p>Function that fits a predictive model, such as <code>glm</code> or
<code>rpart</code>. The function must accept at least two arguments, the first one
being a formula and the second a data.frame with the learning sample.</p></td>
    </tr>
    <tr>
      <th>model_args</th>
      <td><p>Arguments to be passed to <code>model_fun</code> (in addition to the
<code>formula</code> and <code>data</code> argument, which are provided by sperrorest)</p></td>
    </tr>
    <tr>
      <th>pred_fun</th>
      <td><p>Prediction function for a fitted model object created by
<code>model</code>. Must accept at least two arguments: the fitted <code>object</code> and a
<code>data.frame</code> <code>newdata</code> with data on which to predict the outcome.</p></td>
    </tr>
    <tr>
      <th>pred_args</th>
      <td><p>(optional) Arguments to <code>pred_fun</code> (in addition to the
fitted model object and the <code>newdata</code> argument, which are provided by
sperrorest).</p></td>
    </tr>
    <tr>
      <th>smp_fun</th>
      <td><p>A function for sampling training and test sets from <code>data</code>.
E.g. <a href='partition_kmeans.html'>partition_kmeans</a> for spatial cross-validation using spatial
<em>k</em>-means clustering.</p></td>
    </tr>
    <tr>
      <th>smp_args</th>
      <td><p>(optional) Arguments to be passed to <code>smp_fun</code>.</p></td>
    </tr>
    <tr>
      <th>train_fun</th>
      <td><p>(optional) A function for resampling or subsampling the
training sample in order to achieve, e.g., uniform sample sizes on all
training sets, or maintaining a certain ratio of positives and negatives in
training sets. E.g. <a href='resample_uniform.html'>resample_uniform</a> or <a href='resample_strat_uniform.html'>resample_strat_uniform</a>.</p></td>
    </tr>
    <tr>
      <th>train_param</th>
      <td><p>(optional) Arguments to be passed to <code>resample_fun</code>.</p></td>
    </tr>
    <tr>
      <th>test_fun</th>
      <td><p>(optional) Like <code>train_fun</code> but for the test set.</p></td>
    </tr>
    <tr>
      <th>test_param</th>
      <td><p>(optional) Arguments to be passed to <code>test_fun</code>.</p></td>
    </tr>
    <tr>
      <th>err_fun</th>
      <td><p>A function that calculates selected error measures from the
known responses in <code>data</code> and the model predictions delivered by
<code>pred_fun</code>. E.g. <a href='err_default.html'>err_default</a> (the default).</p></td>
    </tr>
    <tr>
      <th>imp_variables</th>
      <td><p>(optional; used if <code>importance = TRUE</code>). Variables for
which permutation-based variable importance assessment is performed. If
<code>importance = TRUE</code> and <code>imp_variables</code> == <code>NULL</code>, all variables in
<code>formula</code> will be used.</p></td>
    </tr>
    <tr>
      <th>imp_permutations</th>
      <td><p>(optional; used if <code>importance = TRUE</code>). Number of
permutations used for variable importance assessment.</p></td>
    </tr>
    <tr>
      <th>imp_sample_from</th>
      <td><p>(default: <code>"test"</code>): specified if the permuted feature
values should be taken from the test set, the training set (a rather unlikely
choice), or the entire sample (<code>"all"</code>). The latter is useful in
leave-one-out resampling situations where the test set is simply too small
to perform any kind of resampling. In any case importances are
always estimates on the test set. (Note that resampling with replacement is
used if the test set is larger than the set from which the permuted values
are to be taken.)</p></td>
    </tr>
    <tr>
      <th>importance</th>
      <td><p>logical (default: <code>FALSE</code>): perform permutation-based
variable importance assessment?</p></td>
    </tr>
    <tr>
      <th>distance</th>
      <td><p>logical (default: <code>FALSE</code>): if <code>TRUE</code>, calculate mean
nearest-neighbour distances from test samples to training samples using
<a href='add.distance.html'>add.distance.represampling</a>.</p></td>
    </tr>
    <tr>
      <th>do_gc</th>
      <td><p>numeric (default: 1): defines frequency of memory garbage
collection by calling <a href='https://rdrr.io/r/base/gc.html'>gc</a>; if <code>&lt; 1</code>, no garbage collection; if <code>&gt;= 1</code>, run
a <a href='https://rdrr.io/r/base/gc.html'>gc</a> after each repetition; if <code>&gt;= 2</code>, after each fold.</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>character (default: <code>all</code>): Whether to show progress
information (if possible). Default shows repetition, fold and (if enabled)
variable importance progress. Set to <code>"rep"</code> for repetition information
only or <code>FALSE</code> for no progress information.</p></td>
    </tr>
    <tr>
      <th>benchmark</th>
      <td><p>(optional) logical (default: <code>FALSE</code>): if <code>TRUE</code>, perform
benchmarking and return <code>sperrorestbenchmark</code> object.</p></td>
    </tr>
    <tr>
      <th>mode_rep, mode_fold</th>
      <td><p>character (default: <code>"future"</code> and <code>"sequential"</code>,
respectively): specifies whether to parallelize the execution at the repetition
level, at the fold level, or not at all.
Parallel execution uses <code><a href='https://rdrr.io/pkg/future.apply/man/future_lapply.html'>future.apply::future_lapply()</a></code> (see details below).
It is only possible to parallelize at the repetition level or at
the fold level.
The <code>"loop"</code> option uses a <code>for</code> loop instead of an <code>lappy</code>
function; this option is for debugging purposes.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Controls the amount of information printed while processing.
Defaults to 0 (no output).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list (object of class sperrorest) with (up to) six components:</p><ul>
<li><p>error_rep: <code>sperrorestreperror</code> containing
predictive performances at the repetition level</p></li>
<li><p>error_fold: <code>sperroresterror</code> object containing predictive
performances at the fold level</p></li>
<li><p>represampling: <a href='as.represampling.html'>represampling</a> object</p></li>
<li><p>importance: <code>sperrorestimportance</code> object containing
permutation-based variable importances at the fold level</p></li>
<li><p>benchmark: <code>sperrorestbenchmark</code> object containing
information on the system the code is running on, starting and
finishing times, number of available CPU cores and runtime performance</p></li>
<li><p>package_version: <code>sperrorestpackageversion</code> object containing
information about the sperrorest package version</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Custom predict functions passed to <code>pred_fun</code>, which consist of
multiple child functions, must be defined in one function.</p>
    <h2 class="hasAnchor" id="parallelization"><a class="anchor" href="#parallelization"></a>Parallelization</h2>

    


<p>Running in parallel is supported via package <a href='https://CRAN.R-project.org/package=future'><span class="pkg">future</span></a>.
Have a look at <code>vignette("future-1-overview", package = "future")</code>.
In short: Choose a backend and specify the number of workers, then call
<code>sperrorest()</code> as usual. Example:<div class="sourceCode r"></p><pre><span class='fu'>future</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/future/man/plan.html'>plan</a></span><span class='op'>(</span><span class='fu'>future.callr</span><span class='fu'>::</span><span class='va'>callr</span>, workers <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
<span class='fu'>sperrorest</span><span class='op'>(</span><span class='op'>)</span>
</pre><p></div></p>
<p>Parallelization at the repetition is recommended when using
repeated cross-validation. If the 'granularity' of parallelized
function calls is too fine, the overall runtime will be very
poor since the overhead for passing arguments and handling
environments becomes too large. Use fold-level parallelization
only when the processing time of individual folds is very
large and the number of repetitions is small or equals 1.</p>
<p>Note that nested calls to <code>future</code> are not possible.
Therefore a sequential <code>sperrorest</code> call should be used for
hyperparameter tuning in a nested cross-validation.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Brenning, A. 2012. Spatial cross-validation and bootstrap for
the assessment of prediction rules in remote sensing: the R package
'sperrorest'.
2012 IEEE International Geoscience and Remote Sensing Symposium (IGARSS),
23-27 July 2012, p. 5372-5375.
<a href='https://ieeexplore.ieee.org/document/6352393'>https://ieeexplore.ieee.org/document/6352393</a></p>
<p>Brenning, A. 2005. Spatial prediction models for landslide hazards: review,
comparison and evaluation. Natural Hazards and Earth System Sciences,
5(6), 853-862. <a href='https://doi.org/10.5194/nhess-5-853-2005'>https://doi.org/10.5194/nhess-5-853-2005</a></p>
<p>Brenning, A., S. Long &amp; P. Fieguth. 2012. Detecting rock glacier
flow structures using Gabor filters and IKONOS imagery.
Remote Sensing of Environment, 125, 227-237.
<a href='http://dx.doi.org/10.1016/j.rse.2012.07.005'>http://dx.doi.org/10.1016/j.rse.2012.07.005</a></p>
<p>Russ, G. &amp; A. Brenning. 2010a. Data mining in precision agriculture:
Management of spatial information. In 13th International Conference on
Information Processing and Management of Uncertainty, IPMU 2010; Dortmund;
28 June - 2 July 2010. Lecture Notes in Computer Science, 6178 LNAI: 350-359.</p>
<p>Russ, G. &amp; A. Brenning. 2010b. Spatial variable importance assessment for
yield prediction in Precision Agriculture. In Advances in Intelligent
Data Analysis IX, Proceedings, 9th International Symposium,
IDA 2010, Tucson, AZ, USA, 19-21 May 2010.
Lecture Notes in Computer Science, 6065 LNCS: 184-195.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## ------------------------------------------------------------</span>
<span class='co'>## Classification tree example using non-spatial partitioning</span>
<span class='co'>## ------------------------------------------------------------</span>

<span class='co'># Muenchow et al. (2012), see ?ecuador</span>
<span class='va'>fo</span> <span class='op'>&lt;-</span> <span class='va'>slides</span> <span class='op'>~</span> <span class='va'>dem</span> <span class='op'>+</span> <span class='va'>slope</span> <span class='op'>+</span> <span class='va'>hcurv</span> <span class='op'>+</span> <span class='va'>vcurv</span> <span class='op'>+</span> <span class='va'>log.carea</span> <span class='op'>+</span> <span class='va'>cslope</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/bethatkinson/rpart'>rpart</a></span><span class='op'>)</span>
<span class='va'>mypred_part</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>newdata</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>newdata</span><span class='op'>)</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span>
<span class='va'>ctrl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/rpart/man/rpart.control.html'>rpart.control</a></span><span class='op'>(</span>cp <span class='op'>=</span> <span class='fl'>0.005</span><span class='op'>)</span> <span class='co'># show the effects of overfitting</span>
<span class='co'># show the effects of overfitting</span>
<span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/rpart/man/rpart.html'>rpart</a></span><span class='op'>(</span><span class='va'>fo</span>, data <span class='op'>=</span> <span class='va'>ecuador</span>, control <span class='op'>=</span> <span class='va'>ctrl</span><span class='op'>)</span>

<span class='co'>### Non-spatial cross-validation:</span>
<span class='va'>mypred_part</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>newdata</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>newdata</span><span class='op'>)</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span>
<span class='va'>nsp_res</span> <span class='op'>&lt;-</span> <span class='fu'>sperrorest</span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='va'>ecuador</span>, formula <span class='op'>=</span> <span class='va'>fo</span>,
  model_fun <span class='op'>=</span> <span class='va'>rpart</span>,
  model_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>control <span class='op'>=</span> <span class='va'>ctrl</span><span class='op'>)</span>,
  pred_fun <span class='op'>=</span> <span class='va'>mypred_part</span>,
  progress <span class='op'>=</span> <span class='cn'>TRUE</span>,
  smp_fun <span class='op'>=</span> <span class='va'>partition_cv</span>,
  smp_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>repetition <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>, nfold <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; Fri Jul 30 04:26:32 2021 Repetition 1 
#&gt; Fri Jul 30 04:26:32 2021 Repetition - Fold 1 
#&gt; Fri Jul 30 04:26:32 2021 Repetition - Fold 2 
#&gt; Fri Jul 30 04:26:32 2021 Repetition - Fold 3 
#&gt; Fri Jul 30 04:26:32 2021 Repetition 2 
#&gt; Fri Jul 30 04:26:32 2021 Repetition - Fold 1 
#&gt; Fri Jul 30 04:26:32 2021 Repetition - Fold 2 
#&gt; Fri Jul 30 04:26:32 2021 Repetition - Fold 3 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>nsp_res</span><span class='op'>$</span><span class='va'>error_rep</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                           mean           sd       median          IQR
#&gt; train_auroc          0.8413531 0.0002190341    0.8413531 0.0001548805
#&gt; train_error          0.1917443 0.0018831073    0.1917443 0.0013315579
#&gt; train_accuracy       0.8082557 0.0018831073    0.8082557 0.0013315579
#&gt; train_sensitivity    0.8855000 0.0120208153    0.8855000 0.0085000000
#&gt; train_specificity    0.6543825 0.0295801642    0.6543825 0.0209163347
#&gt; train_fpr70          0.2051793 0.0140857925    0.2051793 0.0099601594
#&gt; train_fpr80          0.2559761 0.0042257377    0.2559761 0.0029880478
#&gt; train_fpr90          0.3954183 0.0042257377    0.3954183 0.0029880478
#&gt; train_tpr80          0.6990000 0.0268700577    0.6990000 0.0190000000
#&gt; train_tpr90          0.4380000 0.0212132034    0.4380000 0.0150000000
#&gt; train_tpr95          0.2870000 0.0141421356    0.2870000 0.0100000000
#&gt; train_events      1000.0000000 0.0000000000 1000.0000000 0.0000000000
#&gt; train_count       1502.0000000 0.0000000000 1502.0000000 0.0000000000
#&gt; test_auroc           0.5913347 0.0145196349    0.5913347 0.0102669323
#&gt; test_error           0.3741678 0.0000000000    0.3741678 0.0000000000
#&gt; test_accuracy        0.6258322 0.0000000000    0.6258322 0.0000000000
#&gt; test_sensitivity     0.7420000 0.0169705627    0.7420000 0.0120000000
#&gt; test_specificity     0.3944223 0.0338059019    0.3944223 0.0239043825
#&gt; test_fpr70           0.5517928 0.0084514755    0.5517928 0.0059760956
#&gt; test_fpr80           0.6812749 0.0225372679    0.6812749 0.0159362550
#&gt; test_fpr90           0.8705179 0.0366230604    0.8705179 0.0258964143
#&gt; test_tpr80           0.2720000 0.0678822510    0.2720000 0.0480000000
#&gt; test_tpr90           0.1590000 0.0183847763    0.1590000 0.0130000000
#&gt; test_tpr95           0.0920000 0.0056568542    0.0920000 0.0040000000
#&gt; test_events        500.0000000 0.0000000000  500.0000000 0.0000000000
#&gt; test_count         751.0000000 0.0000000000  751.0000000 0.0000000000</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>nsp_res</span><span class='op'>$</span><span class='va'>error_fold</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                           mean         sd      median         IQR
#&gt; train.auroc         0.83743699 0.02048053   0.8333183 0.033646385
#&gt; train.error         0.19173586 0.01438586   0.1967984 0.014375250
#&gt; train.accuracy      0.80826414 0.01438586   0.8032016 0.014375250
#&gt; train.sensitivity   0.88544232 0.03107595   0.8810630 0.039594807
#&gt; train.specificity   0.65315955 0.07978799   0.6303327 0.123423546
#&gt; train.fpr70         0.21096473 0.03745328   0.2102482 0.039804792
#&gt; train.fpr80         0.26678331 0.04197401   0.2696150 0.055188199
#&gt; train.fpr90         0.41645165 0.05634835   0.4302107 0.027201786
#&gt; train.tpr80         0.67328390 0.09501731   0.7081574 0.136802093
#&gt; train.tpr90         0.42606490 0.02625749   0.4288201 0.038100185
#&gt; train.tpr95         0.24519417 0.10272755   0.2306974 0.135858369
#&gt; train.events      333.33333333 6.47044563 334.0000000 5.750000000
#&gt; train.count       500.66666667 0.51639778 501.0000000 0.750000000
#&gt; test.auroc          0.59363657 0.03339583   0.5821419 0.002435316
#&gt; test.error          0.37417530 0.02708388   0.3712590 0.010470120
#&gt; test.accuracy       0.62582470 0.02708388   0.6287410 0.010470120
#&gt; test.sensitivity    0.74203609 0.03728947   0.7396495 0.067245950
#&gt; test.specificity    0.39550360 0.06362015   0.4024297 0.088476560
#&gt; test.fpr70          0.56470600 0.04071028   0.5440798 0.046597213
#&gt; test.fpr80          0.72560279 0.05383697   0.7249146 0.046820219
#&gt; test.fpr90          0.85173443 0.03938630   0.8563455 0.020751291
#&gt; test.tpr80          0.23524330 0.11922537   0.2271224 0.108842594
#&gt; test.tpr90          0.12384858 0.07164059   0.1309382 0.038435952
#&gt; test.tpr95          0.06825989 0.07977265   0.0511169 0.059644324
#&gt; test.events       166.66666667 6.47044563 166.0000000 5.750000000
#&gt; test.count        250.33333333 0.51639778 250.0000000 0.750000000
#&gt; distance           -1.00000000 0.00000000  -1.0000000 0.000000000</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>nsp_res</span><span class='op'>$</span><span class='va'>represampling</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $`1`
#&gt;   n.train n.test
#&gt; 1     500    251
#&gt; 2     501    250
#&gt; 3     501    250
#&gt; 
#&gt; $`2`
#&gt;   n.train n.test
#&gt; 1     501    250
#&gt; 2     501    250
#&gt; 3     500    251
#&gt; </div><div class='input'><span class='co'># plot(nsp_res$represampling, ecuador)</span>

<span class='co'>### Spatial cross-validation:</span>
<span class='va'>sp_res</span> <span class='op'>&lt;-</span> <span class='fu'>sperrorest</span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='va'>ecuador</span>, formula <span class='op'>=</span> <span class='va'>fo</span>,
  model_fun <span class='op'>=</span> <span class='va'>rpart</span>,
  model_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>control <span class='op'>=</span> <span class='va'>ctrl</span><span class='op'>)</span>,
  pred_fun <span class='op'>=</span> <span class='va'>mypred_part</span>,
  progress <span class='op'>=</span> <span class='cn'>TRUE</span>,
  smp_fun <span class='op'>=</span> <span class='va'>partition_kmeans</span>,
  smp_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>repetition <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>, nfold <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; Fri Jul 30 04:26:33 2021 Repetition 1 
#&gt; Fri Jul 30 04:26:33 2021 Repetition - Fold 1 
#&gt; Fri Jul 30 04:26:33 2021 Repetition - Fold 2 
#&gt; Fri Jul 30 04:26:33 2021 Repetition - Fold 3 
#&gt; Fri Jul 30 04:26:33 2021 Repetition 2 
#&gt; Fri Jul 30 04:26:33 2021 Repetition - Fold 1 
#&gt; Fri Jul 30 04:26:33 2021 Repetition - Fold 2 
#&gt; Fri Jul 30 04:26:33 2021 Repetition - Fold 3 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>sp_res</span><span class='op'>$</span><span class='va'>error_rep</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                           mean          sd       median         IQR
#&gt; train_auroc          0.8472530 0.017474834    0.8472530 0.012356574
#&gt; train_error          0.1820905 0.002353884    0.1820905 0.001664447
#&gt; train_accuracy       0.8179095 0.002353884    0.8179095 0.001664447
#&gt; train_sensitivity    0.8905000 0.009192388    0.8905000 0.006500000
#&gt; train_specificity    0.6733068 0.011268634    0.6733068 0.007968127
#&gt; train_fpr70          0.1842629 0.029580164    0.1842629 0.020916335
#&gt; train_fpr80          0.2370518 0.011268634    0.2370518 0.007968127
#&gt; train_fpr90          0.3555777 0.012677213    0.3555777 0.008964143
#&gt; train_tpr80          0.7360000 0.053740115    0.7360000 0.038000000
#&gt; train_tpr90          0.4845000 0.067175144    0.4845000 0.047500000
#&gt; train_tpr95          0.2660000 0.024041631    0.2660000 0.017000000
#&gt; train_events      1000.0000000 0.000000000 1000.0000000 0.000000000
#&gt; train_count       1502.0000000 0.000000000 1502.0000000 0.000000000
#&gt; test_auroc           0.5032968 0.024889595    0.5032968 0.017599602
#&gt; test_error           0.4727031 0.028246609    0.4727031 0.019973369
#&gt; test_accuracy        0.5272969 0.028246609    0.5272969 0.019973369
#&gt; test_sensitivity     0.5470000 0.032526912    0.5470000 0.023000000
#&gt; test_specificity     0.4880478 0.019720109    0.4880478 0.013944223
#&gt; test_fpr70           0.7529880 0.061977487    0.7529880 0.043824701
#&gt; test_fpr80           0.8884462 0.056343170    0.8884462 0.039840637
#&gt; test_fpr90           0.9282869 0.000000000    0.9282869 0.000000000
#&gt; test_tpr80           0.1610000 0.004242641    0.1610000 0.003000000
#&gt; test_tpr90           0.0990000 0.007071068    0.0990000 0.005000000
#&gt; test_tpr95           0.0650000 0.018384776    0.0650000 0.013000000
#&gt; test_events        500.0000000 0.000000000  500.0000000 0.000000000
#&gt; test_count         751.0000000 0.000000000  751.0000000 0.000000000</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>sp_res</span><span class='op'>$</span><span class='va'>error_fold</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                           mean          sd       median          IQR
#&gt; train.auroc         0.84515941  0.01905839   0.84534979  0.028026750
#&gt; train.error         0.18240710  0.01060702   0.18304622  0.009904172
#&gt; train.accuracy      0.81759290  0.01060702   0.81695378  0.009904172
#&gt; train.sensitivity   0.88941674  0.01990945   0.88819737  0.018551212
#&gt; train.specificity   0.67338381  0.03405612   0.67399773  0.033408639
#&gt; train.fpr70         0.19001989  0.02696925   0.18629168  0.035076259
#&gt; train.fpr80         0.26077121  0.03429704   0.25571965  0.040338724
#&gt; train.fpr90         0.38765695  0.03869441   0.38784530  0.057629711
#&gt; train.tpr80         0.69871754  0.06961726   0.71852900  0.077197624
#&gt; train.tpr90         0.38222915  0.12415524   0.37383597  0.127049184
#&gt; train.tpr95         0.24811503  0.08804794   0.21752928  0.118033864
#&gt; train.events      333.33333333 44.88503834 326.50000000 50.500000000
#&gt; train.count       500.66666667 52.87217290 490.00000000 65.500000000
#&gt; test.auroc          0.52865230  0.04745692   0.53136288  0.078210920
#&gt; test.error          0.46155050  0.07803414   0.43884387  0.080997314
#&gt; test.accuracy       0.53844950  0.07803414   0.56115613  0.080997314
#&gt; test.sensitivity    0.58378570  0.19028544   0.64871054  0.191650843
#&gt; test.specificity    0.47751069  0.16408495   0.45386905  0.161617488
#&gt; test.fpr70          0.74420320  0.12039194   0.75586762  0.182721973
#&gt; test.fpr80          0.84903452  0.12630703   0.87089783  0.074518397
#&gt; test.fpr90          0.96263035  0.03429537   0.95823650  0.044154776
#&gt; test.tpr80          0.15410646  0.07515119   0.15269750  0.066471765
#&gt; test.tpr90          0.10004200  0.06560359   0.12034188  0.094070539
#&gt; test.tpr95          0.04934735  0.07259254   0.01269036  0.075709340
#&gt; test.events       166.66666667 44.88503834 173.50000000 50.500000000
#&gt; test.count        250.33333333 52.87217290 261.00000000 65.500000000
#&gt; distance           -1.00000000  0.00000000  -1.00000000  0.000000000</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>sp_res</span><span class='op'>$</span><span class='va'>represampling</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $`1`
#&gt;   n.train n.test
#&gt; 1     498    253
#&gt; 2     573    178
#&gt; 3     431    320
#&gt; 
#&gt; $`2`
#&gt;   n.train n.test
#&gt; 1     482    269
#&gt; 2     469    282
#&gt; 3     551    200
#&gt; </div><div class='input'><span class='co'># plot(sp_res$represampling, ecuador)</span>

<span class='va'>smry</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
  nonspat_training <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>nsp_res</span><span class='op'>$</span><span class='va'>error_rep</span>,
    level <span class='op'>=</span> <span class='fl'>1</span>
  <span class='op'>)</span><span class='op'>$</span><span class='va'>train_auroc</span><span class='op'>)</span>,
  nonspat_test <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>nsp_res</span><span class='op'>$</span><span class='va'>error_rep</span>,
    level <span class='op'>=</span> <span class='fl'>1</span>
  <span class='op'>)</span><span class='op'>$</span><span class='va'>test_auroc</span><span class='op'>)</span>,
  spatial_training <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>sp_res</span><span class='op'>$</span><span class='va'>error_rep</span>,
    level <span class='op'>=</span> <span class='fl'>1</span>
  <span class='op'>)</span><span class='op'>$</span><span class='va'>train_auroc</span><span class='op'>)</span>,
  spatial_test <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>sp_res</span><span class='op'>$</span><span class='va'>error_rep</span>,
    level <span class='op'>=</span> <span class='fl'>1</span>
  <span class='op'>)</span><span class='op'>$</span><span class='va'>test_auroc</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span><span class='op'>(</span><span class='va'>smry</span>,
  col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"red"</span>, <span class='st'>"red"</span>, <span class='st'>"red"</span>, <span class='st'>"green"</span><span class='op'>)</span>,
  main <span class='op'>=</span> <span class='st'>"Training vs. test, nonspatial vs. spatial"</span>,
  ylab <span class='op'>=</span> <span class='st'>"Area under the ROC curve"</span>
<span class='op'>)</span>
</div><div class='img'><img src='sperrorest-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexander Brenning, Patrick Schratz, Tobias Herrmann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


